{% extends "passy/base.html" %}

{% load static %}

{% block head_scripts %}
    {{ block.super }}
    <script src="{% static "clipboard/dist/clipboard.min.js" %}"></script>
    <script src="{% static "passy/password.js" %}"></script>
{% endblock head_scripts%}

{% block content %}

    {% block start_content %}
    {% endblock start_content %}

    {% block base_form %}
        <form action="{% block form_url %}{% endblock form_url %}" method="post">
            {% csrf_token %}

            <div class="form-group">
                <label for="site">Site</label>
                {% for error in form.errors.site %}
                    <div class="alert alert-danger" role="alert">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        <span class="sr-only">Error:</span>
                        {{ error|escape }}
                    </div>
                {% endfor %}
                <input name="site" id="site" class="form-control" type="text" placeholder="Enter website or application name" value="{{ form.site }}" required>
            </div>

            <div class="form-group">
                <label for="stored_password_text">New password</label>
                {% for error in form.errors.stored_password_text %}
                    <div class="alert alert-danger" role="alert">
                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                        <span class="sr-only">Error:</span>
                        {{ error|escape }}
                    </div>
                {% endfor %}
                <div class="input-group">
                    <input name="stored_password_text" id="stored_password_text" class="form-control" type="text" value="{{ form.stored_password_text }}" required>
                    <div class="input-group-btn">
                        <button class="btn btn-default" type="button" onclick="document.getElementById('hidden_get_another_password_button').click()">
                            <span class="glyphicon glyphicon-refresh"></span>
                        </button>
                        <button class="btn btn-default" id="clipboard_new_password" type="button" data-clipboard-target="#stored_password_text">
                            <span class="glyphicon glyphicon-copy"></span>
                        </button>
                        <button class="btn btn-default" type="button" data-toggle="collapse" data-target="#collapse_get_random_password_form">
                            <span class="glyphicon glyphicon-chevron-down"></span>
                        </button>
                    </div>
                </div>
            </div>

            {% block form_hidden_buttons %}
            {% endblock form_hidden_buttons %}
        </form>
        <div class="collapse" id="collapse_get_random_password_form">
            <div class="panel panel-default">
                <div class="panel-body">
                    <form id="get_random_password_form" action="{% url 'passy:get_random_password' %}">
                        <div class="form-group">
                            <label for="length">Length</label>
                            <div class="input-group">
                                <input name="length" id="length" type="text" value="{{ new_password_default_length }}"
                                       pattern="^[0-9]+$" title="numbers only" class="form-control" required>
                                <span class="input-group-btn">
                                    <button class="btn btn-default" type="button" onclick="lowerLength('length')">
                                        <span class="glyphicon glyphicon-minus"></span>
                                    </button>
                                </span>
                                <span class="input-group-btn">
                                    <button class="btn btn-default" type="button" onclick="raiseLength('length')">
                                        <span class="glyphicon glyphicon-plus"></span>
                                    </button>
                                </span>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox" name="use_symbols" checked>Use symbols
                                </label>
                            </div>
                        </div>

                        <input id="hidden_get_another_password_button" type="submit" style="visibility:hidden;display:none">
                    </form>
                </div>
            </div>
        </div>
        {% block form_buttons %}
        {% endblock form_buttons %}
    {% endblock base_form %}

    {% block footer_scripts %}
        <script>initClipboard()</script>
        <script>initGetRandomPasswordForm()</script>
    {% endblock footer_scripts %}
{% endblock content %}
